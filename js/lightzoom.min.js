$.fn.lightzoom = function (s) { var t, e = $.extend({ zoomPower: 3, glassSize: 175 }, s), c = e.glassSize / 2, u = e.glassSize / 4, p = e.zoomPower; $("body").append('<div id="glass"></div>'), $("html > head").append($("<style> #glass{width: " + e.glassSize + "px; height: " + e.glassSize + "px;}</style>")); return $("#glass").mousemove(function (s) { var e = this.targ; s.target = e, t(s, e) }), this.mousemove(function (s) { t(s, this) }), t = function (s, e) { document.getElementById("glass").targ = e; var t = s.pageX, o = s.pageY, i = e.getBoundingClientRect(), a = i.width, n = i.height, g = $(e).offset(), l = g.left, r = g.top; if (l < t && t < l + a && r < o && o < r + n) { offsetXfixer = (t - l - a / 2) / (a / 2) * u, offsetYfixer = (o - r - n / 2) / (n / 2) * u; var f = (t - l + offsetXfixer) / a * 100, d = (o - r + offsetYfixer) / n * 100; o -= c, t -= c, $("#glass").css({ top: o, left: t, "background-image": " url('" + e.src + "')", "background-size": a * p + "px " + n * p + "px", "background-position": f + "% " + d + "%", display: "inline-block" }), $("body").css("cursor", "none") } else $("#glass").css("display", "none"), $("body").css("cursor", "default") }, this };